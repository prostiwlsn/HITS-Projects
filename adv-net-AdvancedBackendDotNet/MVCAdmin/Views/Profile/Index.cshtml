@using Common.Models
@model ProfileEditModel
@{
}
<div class="d-flex flex-column">
    @using (Html.BeginForm("Edit", "Profile", FormMethod.Post, new { id = "profileForm" }))
    {
        <div class="form-group">
            @Html.LabelFor(m => m.Name)
            @Html.TextBoxFor(m => m.Name, new { @class = "form-control" })
            @Html.ValidationMessageFor(m => m.Name, "", new { @class = "text-danger" })
        </div>

        <div class="form-group">
            @Html.LabelFor(m => m.Surname)
            @Html.TextBoxFor(m => m.Surname, new { @class = "form-control" })
            @Html.ValidationMessageFor(m => m.Surname, "", new { @class = "text-danger" })
        </div>

        <div class="form-group">
            @Html.LabelFor(m => m.SecondName)
            @Html.TextBoxFor(m => m.SecondName, new { @class = "form-control" })
            @Html.ValidationMessageFor(m => m.SecondName, "", new { @class = "text-danger" })
        </div>

        <div class="form-group">
            @Html.LabelFor(m => m.PhoneNumber)
            @Html.TextBoxFor(m => m.PhoneNumber, new { @class = "form-control" })
            @Html.ValidationMessageFor(m => m.PhoneNumber, "", new { @class = "text-danger" })
        </div>

        <div class="form-group">
            @Html.LabelFor(m => m.Gender)
            @Html.DropDownListFor(m => m.Gender, new SelectList(Enum.GetValues(typeof(Gender))), "Select Gender", new { @class = "form-control" })
            @Html.ValidationMessageFor(m => m.Gender, "", new { @class = "text-danger" })
        </div>


        <div class="form-group">
            @Html.LabelFor(m => m.Citizenship)
            @Html.TextBoxFor(m => m.Citizenship, new { @class = "form-control" })
            @Html.ValidationMessageFor(m => m.Citizenship, "", new { @class = "text-danger" })
        </div>

        <button type="submit" class="btn btn-primary">Submit</button>
    }
    <a asp-controller="Home" asp-action="ChangePassword">Change password</a>
    <a asp-controller="Home" asp-action="ChangeEmail">Change email</a>
    <div id="alert-placeholder"></div>
</div>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script>
    $(document).ready(function () {
        $('#profileForm').on('submit', function (e) {
            e.preventDefault();

            $.ajax({
                type: 'POST',
                url: $(this).attr('action'),
                data: $(this).serialize(),
                success: function (response) {
                    $('#alert-placeholder').html(
                        '<div class="alert alert-success position-fixed" role="alert">' +
                        'Profile updated successfully!' +
                        '</div>'
                    );
                },
                error: function (error) {
                    $('#alert-placeholder').html(
                        '<div class="alert alert-danger" role="alert">' +
                        'There was an error updating the profile.' +
                        '</div>'
                    );
                }
            });
        });
    });
</script>

@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }
}